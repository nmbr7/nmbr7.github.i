<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="https:&#x2F;&#x2F;nmbr7.github.io&#x2F;main.css" />
  







<meta property="og:type" content="website" />
<meta property="og:description" content="&lt;p&gt;The challenges were good and really fun to solv…" />

<meta name="twitter:title" content="ByteBandits CTF 2020">
<meta name="twitter:description" content="&lt;p&gt;The challenges were good and really fun to solv…">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="&#x2F;default.png">


  <link rel="dns-prefetch" href="//www.google-analytics.com/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=m2llJQPQq8">
  <link rel="icon" type="image/png" sizes="32x32" href="/logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/logo.png">
  <link rel="mask-icon" href="/safari-pinned-tab.svg?v=m2llJQPQq8" color="#5bbad5">
  <link rel="shortcut icon" href="/logo.png">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#ffffff">
  <meta name="author" content="Suhailr7>
  <meta name="description" content="Security Enthusiast interested in  System/Web security, CTFer, UnderGrad Student" />
  <title>Suhail Rafeeq</title>
</head>

<body>
  <div class="container">

    <main>
      
<article>
  <p class='post-meta'>Published on 




13th April, 2020
</p>
  <h1>ByteBandits CTF 2020</h1>
  
  <p>The challenges were good and really fun to solve, our team <code>7SecCTF</code> managed to solve 6 challenges.</p>
<h2 id="the-gremlin-challenge-was-particularly-interesting">The <code>gremlin</code> challenge was particularly interesting</h2>
<hr />
<p>It was a <code>Reverse-Engineering</code> Challenge.<br />
The challenge Description was :</p>
<pre style="background-color:#fafafa;">
<span style="color:#61676c;">There</span><span style="color:#86b300;">&#39;s a gremlin in my machinery. I guess it&#39;</span><span style="color:#61676c;">ll stop working soon</span><span style="color:#ed9366;">.</span><span style="color:#61676c;"> Can you help me</span><span style="color:#ed9366;">?
</span></pre>
<p>along with a file <code>cpg.bin</code> to download<br />
A Hint was also provided</p>
<pre style="background-color:#fafafa;">
<span style="color:#fa6e32;">u32</span><span style="color:#61676c;"> table[</span><span style="color:#ff8f40;">10</span><span style="color:#61676c;">][</span><span style="color:#ff8f40;">2</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">{ {</span><span style="color:#ff8f40;">0xff</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0xfe</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0xfd</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, 
</span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0xfc</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0xfb</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0x00</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0x01</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0x02</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0x03</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676c;">}</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">{</span><span style="color:#ff8f40;">0x04</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">} }</span><span style="color:#61676ccc;">;
</span></pre>
<p>I downloaded the <code>cpg.bin</code> file.</p>
<pre style="background-color:#fafafa;">
<span style="color:#61676c;">grimline </span><span style="color:#ed9366;">&gt;&gt;</span><span style="color:#61676c;"> head cpg</span><span style="color:#ed9366;">.</span><span style="color:#61676c;">bin
H</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">blockSize</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">1000</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">created</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">17168fe53f5</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">format</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">fletcher</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">a504a51d
H</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">blockSize</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">1000</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">created</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">17168fe53f5</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">format</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">fletcher</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">a504a51d
chunk</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">block</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">len</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">map</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">max</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">380</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">next</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">pages</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">root</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">400000c388</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">time</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">3ee</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">version</span><span style="color:#61676ccc;">:</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">  
�</span><span style="color:#ff8f40;">RSTU</span><span style="color:#ed9366;">&#39;</span><span style="color:#61676c;">��</span><span style="color:#ff8f40;">LANGUAGE</span><span style="color:#61676c;">��C��</span><span style="color:#ff8f40;">6</span><span style="color:#61676c;">)��</span><span style="color:#ff8f40;">FULL_NAME</span><span style="color:#61676c;">��</span><span style="color:#ed9366;">&lt;</span><span style="color:#61676c;">global</span><span style="color:#ed9366;">&gt;</span><span style="color:#61676c;">�</span><span style="color:#ff8f40;">NAME</span><span style="color:#61676c;">��</span><span style="color:#ed9366;">&lt;</span><span style="color:#61676c;">global</span><span style="color:#ed9366;">&gt;</span><span style="color:#61676c;">
��</span><span style="color:#ed9366;">@&amp;</span><span style="color:#61676c;">��</span><span style="color:#ff8f40;">NAME</span><span style="color:#61676c;">��</span><span style="color:#86b300;">&quot;/home/jai/Documents/ctf/bbctf/re.c���    �
�y)��FULL_NAME��+/home/jai/Documents/ctf/bbctf/re.c:&lt;global&gt;�NAME��&lt;global&gt;�
��  �   (�  k�  �
�
�
�
�   �
</span></pre>
<p>On running <code>strings</code> command on it, the output contained many strings like <code>LINE_NUMBER</code> <code>ORDER</code> <code>PARSER_TYPE_NAME</code> <code>CODE</code> and also contained some code segments</p>
<pre style="background-color:#fafafa;">
<span style="color:#61676c;">grimline </span><span style="color:#ed9366;">&gt;&gt;</span><span style="color:#61676c;"> strings cpg</span><span style="color:#ed9366;">.</span><span style="color:#61676c;">bin
</span><span style="color:#ed9366;">....
....
....
</span><span style="color:#61676c;">LINE_NUMBER
ORDER
PARSER_TYPE_NAME
ForStatement
CODE
 </span><span style="color:#f29718;">for </span><span style="color:#61676c;">(u8 i </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;"> i </span><span style="color:#ed9366;">&lt;= </span><span style="color:#ff8f40;">key</span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;"> i</span><span style="color:#ed9366;">++</span><span style="color:#61676c;">)
ARGUMENT_INDEX
COLUMN_NUMBER
LINE_NUMBER
CODE
TYPE_FULL_NAME
</span><span style="color:#ed9366;">....
....
....
</span></pre>
<p>the <code>for</code> loop code segment was interesting, the file seemed like something related to CPG(Code Property Graph) representation, But i didn't know anything about CPG, so i examined the <code>strings</code> output for more details, i further came accross many more code segments</p>
<pre style="background-color:#fafafa;">
<span style="color:#ed9366;">...
...
</span><span style="color:#61676c;">CODE
</span><span style="color:#f29718;">while </span><span style="color:#61676c;">(n </span><span style="color:#ed9366;">&gt; </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">)
</span><span style="color:#ed9366;">...
</span><span style="color:#61676c;">CODE
</span><span style="color:#f29718;">printf</span><span style="color:#61676c;">(</span><span style="color:#86b300;">&quot;</span><span style="color:#ff8f40;">%llu</span><span style="color:#86b300;">&quot;</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">out</span><span style="color:#61676c;">[i])
</span><span style="color:#ed9366;">...
</span><span style="color:#86b300;">&quot;</span><span style="color:#ff8f40;">%llu</span><span style="color:#86b300;">&quot;
</span><span style="color:#ed9366;">...
</span><span style="color:#61676c;">CODE
</span><span style="color:#f29718;">printf</span><span style="color:#61676c;">(</span><span style="color:#86b300;">&quot;</span><span style="color:#4cbf99;">\n</span><span style="color:#86b300;">&quot;</span><span style="color:#61676c;">)
</span><span style="color:#ed9366;">...
...
</span></pre>
<p>we can also note that all the code segments are preceded by the string <code>CODE</code>, so i <code>grepped</code> the <code>strings</code> output</p>
<pre style="background-color:#fafafa;">
<span style="color:#61676c;">grimline </span><span style="color:#ed9366;">&gt;&gt;</span><span style="color:#61676c;"> strings cpg</span><span style="color:#ed9366;">.</span><span style="color:#61676c;">bin</span><span style="color:#ed9366;">|</span><span style="color:#61676c;"> grep </span><span style="color:#ff8f40;">CODE </span><span style="color:#ed9366;">-</span><span style="color:#ff8f40;">A1</span><span style="color:#ed9366;">|</span><span style="color:#61676c;">head </span><span style="color:#ed9366;">-</span><span style="color:#61676c;">n30
</span><span style="color:#ff8f40;">CODE
</span><span style="color:#fa6e32;">u64</span><span style="color:#61676c;"> n
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE
COLUMN_NUMBER
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE
ARGUMENT_INDEX
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE
TYPE_FULL_NAME
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE</span><span style="color:#61676c;">
r </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE
ARGUMENT_INDEX
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE
ARGUMENT_INDEX
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE
</span><span style="color:#fa6e32;">while </span><span style="color:#61676c;">(n </span><span style="color:#ed9366;">&gt; </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">)
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE</span><span style="color:#61676c;">
n </span><span style="color:#ed9366;">&gt; </span><span style="color:#ff8f40;">0
</span><span style="color:#ed9366;">--
</span><span style="color:#ff8f40;">CODE
ARGUMENT_INDEX
</span><span style="color:#ed9366;">--
</span></pre>
<p>after cleaning up the strings, we get</p>
<pre style="background-color:#fafafa;">
<span style="color:#fa6e32;">u64</span><span style="color:#61676c;"> n
r </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
</span><span style="color:#fa6e32;">while </span><span style="color:#61676c;">(n </span><span style="color:#ed9366;">&gt; </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">)
n </span><span style="color:#ed9366;">&gt; </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">
r </span><span style="color:#ed9366;">|=</span><span style="color:#61676c;"> n </span><span style="color:#ed9366;">&amp; </span><span style="color:#ff8f40;">0xff</span><span style="color:#61676c;">
n </span><span style="color:#ed9366;">&amp; </span><span style="color:#ff8f40;">0xff
0xff</span><span style="color:#61676c;">
r </span><span style="color:#ed9366;">&lt;&lt;= </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">
n </span><span style="color:#ed9366;">&gt;&gt;= </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">
r </span><span style="color:#ed9366;">&gt;&gt;= </span><span style="color:#ff8f40;">1
</span><span style="color:#fa6e32;">return</span><span style="color:#61676c;"> r</span><span style="color:#61676ccc;">;
</span><span style="color:#fa6e32;">u8 </span><span style="color:#ed9366;">*</span><span style="color:#61676c;">s
</span><span style="color:#fa6e32;">u32 </span><span style="color:#ed9366;">*</span><span style="color:#61676c;">idx
</span><span style="color:#ed9366;">*</span><span style="color:#61676c;">key </span><span style="color:#ed9366;">=</span><span style="color:#61676c;"> table[s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]]
table[s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]]
table
s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]
</span><span style="color:#ed9366;">...
...
...</span><span style="color:#61676c;">
key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">]
</span><span style="color:#fa6e32;">return</span><span style="color:#61676c;"> val</span><span style="color:#61676ccc;">;
</span><span style="color:#fa6e32;">char </span><span style="color:#ed9366;">*</span><span style="color:#61676c;">s
</span><span style="color:#fa6e32;">u32</span><span style="color:#61676c;"> n
sz </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">
idx </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
</span><span style="color:#fa6e32;">while </span><span style="color:#61676c;">(idx </span><span style="color:#ed9366;">&lt;</span><span style="color:#61676c;"> n)
idx </span><span style="color:#ed9366;">&lt;</span><span style="color:#61676c;"> n
</span><span style="color:#ed9366;">*</span><span style="color:#61676c;">key </span><span style="color:#ed9366;">=</span><span style="color:#61676c;"> table[s[idx]]
table[s[idx]]
table
s[idx]
idx </span><span style="color:#ed9366;">+=</span><span style="color:#61676c;"> key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">+ </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">
key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">+ </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">
key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">]
sz</span><span style="color:#ed9366;">++
</span><span style="color:#fa6e32;">return</span><span style="color:#61676c;"> sz</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;">
idx </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
</span><span style="color:#ed9366;">in</span><span style="color:#61676c;">[] </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">{ </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">8</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">\n        </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">8</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7 </span><span style="color:#61676c;">}
</span><span style="color:#ed9366;">...
...
...
</span></pre>
<p>and after cleaning all the repeated code we finally get a rough c code</p>
<pre style="background-color:#fafafa;">
<span style="color:#61676c;">u64 </span><span style="color:#f29718;">n
</span><span style="color:#61676c;">r </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
</span><span style="color:#fa6e32;">while </span><span style="color:#61676c;">(n </span><span style="color:#ed9366;">&gt; </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">){
    r </span><span style="color:#ed9366;">|=</span><span style="color:#61676c;"> n </span><span style="color:#ed9366;">&amp; </span><span style="color:#ff8f40;">0xff</span><span style="color:#61676c;">
    r </span><span style="color:#ed9366;">&lt;&lt;= </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">
    n </span><span style="color:#ed9366;">&gt;&gt;= </span><span style="color:#ff8f40;">1
</span><span style="color:#61676c;">}
r </span><span style="color:#ed9366;">&gt;&gt;= </span><span style="color:#ff8f40;">1
</span><span style="color:#fa6e32;">return</span><span style="color:#61676c;"> r</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;">

u8 </span><span style="color:#ed9366;">*</span><span style="color:#f29718;">s
</span><span style="color:#61676c;">u32 </span><span style="color:#ed9366;">*</span><span style="color:#f29718;">idx

</span><span style="color:#ed9366;">*</span><span style="color:#61676c;">key </span><span style="color:#ed9366;">=</span><span style="color:#61676c;"> table[s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]]
s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">&amp;=</span><span style="color:#61676c;"> key[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]
val </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">
val </span><span style="color:#ed9366;">|=</span><span style="color:#61676c;"> s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]

</span><span style="color:#fa6e32;">for </span><span style="color:#61676c;">(u8 i </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;"> i </span><span style="color:#ed9366;">&lt;=</span><span style="color:#61676c;"> key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;"> i</span><span style="color:#ed9366;">++</span><span style="color:#61676c;">){
    val </span><span style="color:#ed9366;">&lt;&lt;= </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">
    val </span><span style="color:#ed9366;">|=</span><span style="color:#61676c;"> s[i]
    </span><span style="color:#ed9366;">*</span><span style="color:#61676c;">idx </span><span style="color:#ed9366;">+=</span><span style="color:#61676c;"> key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">+ </span><span style="color:#ff8f40;">1
</span><span style="color:#fa6e32;">return</span><span style="color:#61676c;"> val</span><span style="color:#61676ccc;">;

</span><span style="color:#fa6e32;">char </span><span style="color:#ed9366;">*</span><span style="color:#61676c;">s
u32 n
sz </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">
idx </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
</span><span style="color:#fa6e32;">while </span><span style="color:#61676c;">(idx </span><span style="color:#ed9366;">&lt;</span><span style="color:#61676c;"> n){
    </span><span style="color:#ed9366;">*</span><span style="color:#61676c;">key </span><span style="color:#ed9366;">=</span><span style="color:#61676c;"> table[s[idx]]
    idx </span><span style="color:#ed9366;">+=</span><span style="color:#61676c;"> key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">+ </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">
    sz</span><span style="color:#ed9366;">++
</span><span style="color:#fa6e32;">return</span><span style="color:#61676c;"> sz</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;">

idx </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">
in[] </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">{ </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">8</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">8</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7 </span><span style="color:#61676c;">}

len </span><span style="color:#ed9366;">= </span><span style="color:#fa6e32;">sizeof</span><span style="color:#61676c;">(in) </span><span style="color:#ed9366;">/ </span><span style="color:#fa6e32;">sizeof</span><span style="color:#61676c;">(u8)
sz </span><span style="color:#ed9366;">= </span><span style="color:#f29718;">calc_size</span><span style="color:#61676c;">(in</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;"> len)
idx_o </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
</span><span style="color:#ed9366;">*</span><span style="color:#61676c;">out </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">(u64</span><span style="color:#ed9366;">*</span><span style="color:#61676c;">)</span><span style="color:#f07171;">malloc</span><span style="color:#61676c;">(sz </span><span style="color:#ed9366;">* </span><span style="color:#fa6e32;">sizeof</span><span style="color:#61676c;">(u64))

</span><span style="color:#fa6e32;">while </span><span style="color:#61676c;">(idx </span><span style="color:#ed9366;">&lt;</span><span style="color:#61676c;"> len){
    </span><span style="color:#ed9366;">&amp;</span><span style="color:#61676c;">out[idx_o</span><span style="color:#ed9366;">++</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">= </span><span style="color:#f29718;">resolve</span><span style="color:#61676c;">(in </span><span style="color:#ed9366;">+</span><span style="color:#61676c;"> idx</span><span style="color:#61676ccc;">, </span><span style="color:#ed9366;">&amp;</span><span style="color:#61676c;">idx)

</span><span style="color:#fa6e32;">for </span><span style="color:#61676c;">(u32 i </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;"> i </span><span style="color:#ed9366;">&lt;</span><span style="color:#61676c;"> idx_o</span><span style="color:#61676ccc;">;</span><span style="color:#61676c;"> i</span><span style="color:#ed9366;">++</span><span style="color:#61676c;">)
    </span><span style="color:#f07171;">printf</span><span style="color:#61676c;">(</span><span style="color:#86b300;">&quot;</span><span style="color:#ff8f40;">%llu</span><span style="color:#86b300;">&quot;</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;"> out[i])
</span><span style="color:#f07171;">printf</span><span style="color:#61676c;">(</span><span style="color:#86b300;">&quot;</span><span style="color:#4cbf99;">\n</span><span style="color:#86b300;">&quot;</span><span style="color:#61676c;">)
</span><span style="color:#fa6e32;">return </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">;
</span></pre>
<p>we can also see that an array named <code>table</code> is being referred here which appears to be same as the one from the provided <code>Hint</code>.</p>
<p>i then converted the above c code to python which involved removing some size calculation and memory allocation functions </p>
<pre style="background-color:#fafafa;">
<span style="color:#61676c;">table </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">[ [</span><span style="color:#ff8f40;">0xff</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0xfe</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0xfd</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0xfc</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0xfb</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0x00</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0x01</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0x02</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0x03</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0x04</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">] ]

</span><span style="color:#fa6e32;">def </span><span style="color:#f29718;">resolve</span><span style="color:#61676c;">(</span><span style="color:#ff8f40;">s</span><span style="color:#61676ccc;">,</span><span style="color:#ff8f40;">idx</span><span style="color:#61676c;">):
    key </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">table[s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]]
    s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">&amp;= </span><span style="color:#61676c;">key[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]
    val </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
    </span><span style="color:#61676c;">val </span><span style="color:#ed9366;">|= </span><span style="color:#61676c;">s[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]
    </span><span style="color:#fa6e32;">for </span><span style="color:#61676c;">i </span><span style="color:#fa6e32;">in </span><span style="color:#f07171;">range</span><span style="color:#61676c;">(</span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">]</span><span style="color:#ed9366;">+</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">):
        val </span><span style="color:#ed9366;">&lt;&lt;= </span><span style="color:#ff8f40;">1
        </span><span style="color:#61676c;">val </span><span style="color:#ed9366;">|= </span><span style="color:#61676c;">s[i]
    idx </span><span style="color:#ed9366;">+= </span><span style="color:#61676c;">key[</span><span style="color:#ff8f40;">1</span><span style="color:#61676c;">] </span><span style="color:#ed9366;">+ </span><span style="color:#ff8f40;">1
    </span><span style="color:#fa6e32;">return </span><span style="color:#61676c;">(idx</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">val)
</span><span style="color:#fa6e32;">def </span><span style="color:#f29718;">main</span><span style="color:#61676c;">():
    idx </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
    </span><span style="color:#61676c;">ln </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">[ </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">8</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">9</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">5</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">4</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">6</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">1</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">3</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">8</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">2</span><span style="color:#61676ccc;">, </span><span style="color:#ff8f40;">7 </span><span style="color:#61676c;">]
    l </span><span style="color:#ed9366;">= </span><span style="color:#f07171;">len</span><span style="color:#61676c;">(ln)
    idx_o </span><span style="color:#ed9366;">= </span><span style="color:#ff8f40;">0
    </span><span style="color:#61676c;">out</span><span style="color:#ed9366;">= </span><span style="color:#61676c;">[</span><span style="color:#ff8f40;">0</span><span style="color:#61676c;">]</span><span style="color:#ed9366;">*</span><span style="color:#61676c;">l
    </span><span style="color:#fa6e32;">while </span><span style="color:#61676c;">(idx </span><span style="color:#ed9366;">&lt; </span><span style="color:#61676c;">l):
        (idx</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">out[idx_o]) </span><span style="color:#ed9366;">= </span><span style="color:#f29718;">resolve</span><span style="color:#61676c;">(ln[idx</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">]</span><span style="color:#61676ccc;">, </span><span style="color:#61676c;">idx)
        idx_o</span><span style="color:#ed9366;">+=</span><span style="color:#ff8f40;">1
    </span><span style="color:#fa6e32;">for </span><span style="color:#61676c;">i </span><span style="color:#fa6e32;">in </span><span style="color:#f07171;">range</span><span style="color:#61676c;">(</span><span style="color:#ff8f40;">0</span><span style="color:#61676ccc;">,</span><span style="color:#61676c;">idx_o): 
        </span><span style="color:#f07171;">print</span><span style="color:#61676c;">(out[i]</span><span style="color:#61676ccc;">,</span><span style="color:#ff8f40;">end</span><span style="color:#ed9366;">=</span><span style="color:#86b300;">&#39;&#39;</span><span style="color:#61676c;">)
    </span><span style="color:#f07171;">print</span><span style="color:#61676c;">()
    </span><span style="color:#fa6e32;">return </span><span style="color:#ff8f40;">0
</span><span style="color:#f29718;">main</span><span style="color:#61676c;">()
</span></pre>
<p>after running the above python code we get some integer output <code>311329622193015237</code> and the flag is <code>flag{311329622193015237}</code></p>
<p>Initially i thought that it would be hard to solve, mostly because of the low number of solves, but it came out pretty easy.</p>
<p>It was a really good challenge :)</p>


  
  
</article>

    </main>
  </div>
  



  <footer>

    <div class="body">
      <div class="bio">
        <nav>
          <ul>
              <li><a href="/">Home</a></li>
              <li><a href="https://twitter.com/nmbr_7">Twitter</a></li>
              <li> <a href="https://github.com/nmbr7">Github</a></li>
          </ul>
        </nav>
      </div>
    </div>
</footer>

  <script type="text/javascript">
    if (location.hostname !== "localhost" && location.hostname !== "127.0.0.1") {
        window.ga = window.ga || function () {
            (ga.q = ga.q || []).push(arguments)
        };
        ga.l = +new Date;
        ga('create', 'UA-693428-1', 'auto');
        ga('send', 'pageview');
    }
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</body>

</html>
